"0","# 4. Extraction de la compétence principale (top_skill_req) pour chaque entreprise"
"0","# Séparer les compétences en lignes distinctes pour chaque compétence"
"0","data_skills <- emp_offers_clean %>%"
"0","  separate_rows(competences_requises, sep = "",\\s*"") %>%"
"0","  mutate(competences_requises = str_trim(competences_requises))"
"0",""
"0","# Calculer la compétence la plus fréquente pour chaque entreprise"
"0","top_skills <- data_skills %>%"
"0","  group_by(entreprise, competences_requises) %>%"
"0","  summarise(skill_count = n(), .groups = ""drop"") %>%"
"0","  arrange(desc(skill_count)) %>%"
"0","  group_by(entreprise) %>%"
"0","  summarise(top_skill_req = paste(unique(competences_requises[skill_count == max(skill_count)]), collapse = "", ""), .groups = ""drop"")"
"0",""
"0","base_emp <- base_emp %>%"
"0","  left_join(top_skills, by = ""entreprise"")"
